<!DOCTYPE html>
<html>
<head>
  <title>Leaflet Routing with Categories</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <!-- Leaflet Routing Machine CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.css" />
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

  <style>
    #map { height: 100vh; width: 100%; }
    #categoryFilter {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1000;
      padding: 6px 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 8px;
      background: white;
      cursor: pointer;
    }
    button {
      margin-top: 5px;
      padding: 4px 8px;
      font-size: 13px;
      cursor: pointer;
    }
  </style>
</head>
<nav class="relative bg-white-800/50 after:pointer-events-none after:absolute after:inset-x-0 after:bottom-0 after:h-px after:bg-white/10">
  <div class="mx-auto max-w-7xl px-2 sm:px-6 lg:px-8">
    <div class="relative flex h-16 items-center justify-between">
      <div class="absolute inset-y-0 left-0 flex items-center sm:hidden">
        <!-- Mobile menu button-->
        <button type="button" command="--toggle" commandfor="mobile-menu" class="relative inline-flex items-center justify-center rounded-md p-2 text-gray-400 hover:bg-white/5 hover:text-white focus:outline-2 focus:-outline-offset-1 focus:outline-indigo-500">
          <span class="absolute -inset-0.5"></span>
          <span class="sr-only">Open main menu</span>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-slot="icon" aria-hidden="true" class="size-6 in-aria-expanded:hidden">
            <path d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-slot="icon" aria-hidden="true" class="size-6 not-in-aria-expanded:hidden">
            <path d="M6 18 18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </button>
      </div>
      <div class="flex flex-1 items-center justify-center sm:items-stretch sm:justify-start">
        <div class="flex shrink-0 items-center">
          <img src="https://tailwindcss.com/plus-assets/img/logos/mark.svg?color=indigo&shade=500" alt="Your Company" class="h-8 w-auto" />
        </div>
        <div class="hidden sm:ml-6 sm:block">
          <div class="flex space-x-4">
            <!-- Current: "bg-gray-950/50 text-white", Default: "text-gray-300 hover:bg-white/5 hover:text-white" -->
            <a href="home.html" aria-current="page" class="rounded-md bg-blue-600 px-3 py-2 text-sm font-medium text-white">Home</a>
            
          </div>
        </div>
      </div>
      <div class="absolute inset-y-0 right-0 flex items-center pr-2 sm:static sm:inset-auto sm:ml-6 sm:pr-0">
        

        <!-- Profile dropdown -->
        <el-dropdown class="relative ml-3">
          <button class="relative flex rounded-full focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500">
            <span class="absolute -inset-1.5"></span>
            <span class="sr-only">Open user menu</span>
            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSDqZLNNtpV-cNZfqbScWb3_Ny0C15rPO9mgg&s" alt="" class="size-8 rounded-full bg-gray-800 outline -outline-offset-1 outline-white/10" />
          </button>

          
        </el-dropdown>
      </div>
    </div>
  </div>

  <el-disclosure id="mobile-menu" hidden class="block sm:hidden">
    <div class="space-y-1 px-2 pt-2 pb-3">
      <!-- Current: "bg-gray-950/50 text-white", Default: "text-gray-300 hover:bg-white/5 hover:text-white" -->
      <a href="home.html" aria-current="page" class="block rounded-md bg-gray-950/50 px-3 py-2 text-base font-medium text-white">Home</a>

    </div>
  </el-disclosure>
</nav>

<body>
  <!-- Dropdown filter -->
  <select id="categoryFilter">
    <option value="all">Show All</option>
  </select>

  <div id="map"></div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <!-- Leaflet Routing Machine JS -->
  <script src="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.js"></script>

  <script>
    var map = L.map('map').setView([42.6754, 21.2110], 14);

    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    var current_position, current_accuracy;
    var routingControl = null;
    let firstLocation = true;

    // Categories with destinations
    const categories = {
      "🍕Pizza": [
        { name: "Pizza Crust", lat: 42.65244897157923, lng: 21.17176212807544, desc: "Ketu eshte Pizza Crust <br> Vleresimet 4.5 - 5 yje <br> Ale S thot Restoranti i bukur ka shumë mundësi për pica, sanduiç, makarona dhe shumë ushqime të këndshme dhe të shijshme." },
        { name: "Napoli Pizza", lat: 42.653479732786735, lng: 21.16771501628135, desc: "Ketu eshte Napoli Pizza <br> Vleresimet 4.5 - 5 yje <br>Anyle Zogu thot Një nga picabërësit më të mirë të Prishtinës. Kopshti i tyre është gjithashtu i bukur sidomos gjatë orës së artë." },
        { name: "Jana", lat: 42.66292783115419, lng: 21.161553744131684, desc: "Ketu eshte Jana Napolitana <br> Vleresimet 4.8 - 5 yje <br>Diella Sejfijaj thot Ky lokal ofron një ambient të dekoruar me shumë shije dhe kujdes, duke krijuar një atmosferë të ngrohtë dhe familjare. Stafi është jashtëzakonisht mikpritës, duke e bërë eksperiencën akoma më të këndshme." },
        { name: "Ruds Pizza", lat: 42.66050732833732, lng: 21.161825886478464, desc: "Ketu eshte Ruds Pizza <br> Vleresimet 4.6 - 5 yje <br> Kastriot Mucolli thot Pica e tyre është tepër e shijshme, me një kore krokante por të butë, salcë të pasur domatesh dhe sasinë e duhur të djathit." },
        { name: "Sos Pizza", lat: 42.651026823391724, lng: 21.168499103734533, desc: "Ketu eshte Sos Pizza <br> Vleresimet 4.8 - 5 yje <br> Bleona Bullatovci thot Shkova këtu me të gjithë miqtë e mi për darkë dhe patëm picat më të mira absolutisht ndonjëherë!! E rekomandoj patjeter!! ❤️10/10.." },
      ],
      "🍔Hamburger": [
        { name: "Aba", lat: 42.6495931071088, lng: 21.157716800469704, desc: "Juicy handmade burgers." },
         { name: "Route 66 (Kalabria)", lat: 42.64530452935157, lng: 21.155673527375953, desc: "Juicy handmade burgers." }, 
         { name: "Route 66", lat: 42.64846796734142, lng: 21.16848153027561, desc: "Juicy handmade burgers." }, 
         { name: "Buffalo", lat: 42.66121376069884, lng: 21.16092697354637, desc: "Juicy handmade burgers." }, 
         { name: "Smash Burger", lat: 42.65757062695122, lng: 21.151709027685673, desc: "Juicy handmade burgers." }, 
         { name: "Shaban Grill House", lat: 42.66328284322778, lng: 21.163768238683343, desc: "Juicy handmade burgers." }, 
         
      ],
      "🍝Italian": [
        { name: "Napoli", lat: 42.65327465931177, lng: 21.16764192026882, desc: "Anyle Zogu thot Shërbim i shpejtë dhe efikas, ambient komod dhe i rehatshëm, ushqim i mirë dhe çmime shumë të arsyeshme. Do ta rekomandoja për çdo udhëtar në Kosovë." },
        { name: "SETTE-Ristorante Italiano", lat: 42.6580731391406, lng: 21.166656956444875, desc: "Era Ahmeti thot Ushqim, ambient dhe shërbim i mrekullueshëm. Një nga restorantet më të mira italiane në Prishtinë." },
        { name: "Ponte Vecchio", lat: 42.66434685415317, lng: 21.15938891553721, desc: "Blerta Haxha thot Restoranti më komod familjar në qytet. Ushqimi është aq i shijshëm dhe jo shumë i shtrenjtë. Provoni lasagna, makarona ponte (e preferuara ime) dhe tiramisu." },
        { name: "La Napoletana", lat: 42.656035778513825, lng: 21.175143053395796, desc: "Kaltrina Zylfiu thot Home Pica bën pica vërtet të mira në stilin Napoletana! Korja është e lehtë dhe krokante, dhe mbushjet shijojnë super të freskët. Më pëlqeu veçanërisht vaji pikant - ai i shtoi picës vetëm goditjen e duhur." },
        { name: "Restaurant Trattoria", lat: 42.64850207720944, lng: 21.171007998102567, desc: "Ketu eshte Restaurant Trattoria <br> Vleresimet 4.6 - 5 yje <br> Arben Mehani thot Kalova një kohë të mrekullueshme në Trattoria! Bifteku i viçit ishte absolutisht i shijshëm - i butë, i shijshëm dhe i gatuar në përsosmëri. Një atmosferë komode dhe staf miqësor." },
        { name: "Vapiano", lat: 42.658653731872185, lng: 21.15500649763883, desc: "Ketu eshte Vapiano <br> Vleresimet 4.5 - 5 yje <br> Nora Uka thot  Ushqimi ishte absolutisht i lezetshëm, me përbërës të freskët dhe shije të pasura që e bënin çdo pjatë një kënaqësi të kuzhinës. Nga makaronat e gatuara në mënyrë perfekte deri te sallatat e shijshme të freskëta." }
      ],
      "🥙Greek": [
        { name: "Trock Taverna", lat: 42.66184666155505, lng: 21.154231161087417, desc: "Ketu eshte Trock Taverna <br> Vleresimet 4.7 - 5 yje <br> Agon Gjonbalaj thot Absolutisht ushqimi më i mirë që kam shijuar ndonjëherë në një tavernë. Shije, shërbim dhe atmosferë fantastike. Shumë e rekomanduar!." },
        { name: "Baba Ganoush Meze", lat: 42.65936927110693, lng: 21.159702867145086, desc: "Ketu eshte Baba Ganoush Meze <br> Vleresimet 4.8 - 5  yje <br> Fisnik Namlixhiu thot Ushqimi është thjesht super i mirë. Gjithçka është e freskët, e shijshme dhe e bërë me kujdes të vërtetë. Por dip karrota e pjekur? Kjo është zhytja më e mirë që kam pasur ndonjëherë. Krem, pak i tymosur, pak i ëmbël, aq fjalë për fjalë perfekt." },
        { name: "Gagi Restaurant", lat: 42.6635813816616, lng: 21.162249957004892, desc: "Ketu eshte Gagi Restaurant <br> Vleresimet 4.5 - 5 yje <br> Nita D thot Unë porosita pica Gagi, dhe ishte thjesht e mahnitshme! Si fillim, gjithashtu u kënaqa: shije të shijshme dhe produkte me freski të patëmetë. Stafi është mikpritës, i buzëqeshur dhe vërtet i vëmendshëm." },
      ],
      "🍽️Tradicionale": [
        
      { name: "Albanezi Restaurant", lat: 42.66272685109351, lng: 21.162894627352706, desc: "Ketu eshte Alabnezi Restaurant <br> Vleresimet 4.9 - 5 yje <br> Lirian Ramadani thot Restorant i mrekullueshëm. Kishte biftek si dhe kërpudhat dhe të dyja ishin fantastike! Shërbimi ishte gjithashtu super miqësor dhe çmimi absolutisht i drejtë." },
      { name: "Tiffany", lat: 42.66420925376755, lng: 21.15779241254816, desc: "Ketu eshte Tiffany <br> Vleresimet 4.3 - 5 yje <br> Ermal Hasimaj Ushqim tradicional i shijshëm. Shërbim i shkëlqyer. Një ndalesë e rregullt për mua sa herë që vij në Prishtina." },
      { name: "Shpija e Vjeter", lat: 42.66189675700115, lng: 21.16365067323063, desc: "Ketu eshte Shpija e Vjeter <br> Vleresimet 4.2 - 5 yje <br> Valdet S thot Një vend perfekt për të ngrënë dhe për të shijuar shoqëri të mirë. Provoni biftekun e mbushur. Ishte i shijshëm dhe porcioni ishte i duhuri." }
      ],
      "🌮Meksikane": [
        { name: "Mexicana", lat: 42.661204234436234, lng: 21.160461695577766, desc: "Tacos and burritos." },
        { name: "Comandante Marcos", lat: 42.65842667177384, lng: 21.14750149111432, desc: "Tacos and burritos." },
        { name: "Eat Mucho", lat: 42.661950873905205, lng: 21.160258050636724, desc: "Tacos and burritos." },
      ],
      "🥩Steakhouse": [
        { name: "Lisa's Restaurant", lat: 42.664316500225105, lng: 21.159984141189742, desc: "Ketu eshte Lisas Restaurant <br> Vleresimet 4.7 - 5 yje <br> Hasan Kllokoqi thot Lokacion shume i mire, ne qender te Prishtines. Shërbim shumë miqësor dhe i dobishëm që më bën shumë të lehtë zgjedhjen e vaktit. Ushqimi është i freskët dhe shumë i shijshëm." },
        { name: "Master Steakhouse", lat: 42.671125609524076, lng: 21.194274462437463, desc: "Ketu eshte Master Steakhouse <br> Vleresimet 4.6 - 5 yje <br> Besart Recani thot Sinqerisht, gjithçka rreth Masterit ishte në vend. Atmosfera ishte e stilit të lartë, por e ftohtë, ushqimi ishte i jashtëzakonshëm - një nga biftekët më të mirë që kam pasur ndonjëherë." },
        { name: "Sarajeva Steakhouse", lat: 42.66226208644534, lng: 21.16218743268379, desc: "Ketu eshte Sarajeva SteakHouse <br> Vleresimet 4.5 - 5 yje <br> Liridona G thot Vend shumë i bukur dhe elegant, staf i shkëlqyer dhe miqësor, si dhe ushqim fantastik!." },
        { name: "Restaurant Freskia", lat: 42.67221570018321, lng: 21.219102968653218, desc: "Ketu eshte Restaurant Freskia <br> Vleresimet 4.4 - 5 yje <br> Redon Ymeri thot vend i mrekullueshëm për të ardhur me familjen ia vlen dhe një natyrë dhe kafe vërtet e mrekullueshme është e mahnitshme." },
        { name: "Ramazzoti", lat: 42.65035231967197, lng: 21.158815662074307, desc: "Ketu eshte Ramazzoti <br> Vleresimet 4.8 - 5 yje <br> Egzon Potoku thot E adhuroj këtë restorant! Çmimet janë perfekte, ushqimi është i shijshëm dhe stafi është jashtëzakonisht miqësor." },
        { name: "Villa Germia", lat: 42.669488244401435, lng: 21.218743552276937, desc: "Ketu eshte Vila Germia <br> Vleresimet 4.4 - 5 yje <br> Besnik Avdija thot Një nga restorantet më të mirë të vendosur në Prishtinë. Është 5 minuta me makinë nga qendra e qytetit ose 15 minuta me autobusin nr. 4. Me një pozicion të shkëlqyeshëm në fund të luginës së vogël të parkut të Gërmisë." },
        
      ]
    };

    // Store markers by category
    const categoryMarkers = {};

    // Function to route to a clicked destination
    function routeToDestination(destinationLatLng, destinationName) {
      if (!current_position) {
        alert("Your location is not detected yet!");
        return;
      }

      // Remove previous route
      if (routingControl) {
        map.removeControl(routingControl);
      }

      routingControl = L.Routing.control({
        waypoints: [
          current_position.getLatLng(),
          destinationLatLng
        ],
        routeWhileDragging: false,
        showAlternatives: false,
        draggableWaypoints: false,
        addWaypoints: false
      }).addTo(map);
    }

    // Place destination markers with popups
    Object.entries(categories).forEach(([category, places]) => {
      categoryMarkers[category] = [];

      // Add category to dropdown
      const option = document.createElement("option");
      option.value = category;
      option.textContent = category;
      document.getElementById("categoryFilter").appendChild(option);

      places.forEach(dest => {
        const marker = L.marker([dest.lat, dest.lng]);

        const popupContent = `
          <b>${category} - ${dest.name}</b><br>
          ${dest.desc}<br>
          <button onclick="routeToDestination(L.latLng(${dest.lat}, ${dest.lng}), '${dest.name}')">
            Route here
          </button>
        `;

        marker.bindPopup(popupContent);
        marker.addTo(map);

        categoryMarkers[category].push(marker);
      });
    });

    // Handle dropdown filter
    document.getElementById("categoryFilter").addEventListener("change", function() {
      const selected = this.value;

      // Hide all markers first
      Object.values(categoryMarkers).forEach(markers => {
        markers.forEach(m => map.removeLayer(m));
      });

      // Show only selected category
      if (selected === "all") {
        Object.values(categoryMarkers).forEach(markers => {
          markers.forEach(m => m.addTo(map));
        });
      } else {
        categoryMarkers[selected].forEach(m => m.addTo(map));
      }
    });

    // Handle user location
    function onLocationFound(e) {
      if (current_position) {
        map.removeLayer(current_position);
        map.removeLayer(current_accuracy);
      }

      var radius = e.accuracy / 2;

      current_position = L.marker(e.latlng).addTo(map)
        .bindPopup("You are here!").openPopup();

      current_accuracy = L.circle(e.latlng, radius).addTo(map);

      if (firstLocation) {
        map.setView(e.latlng, 14);
        firstLocation = false;
      }
    }

    function onLocationError(e) {
      alert(e.message);
    }

    map.on('locationfound', onLocationFound);
    map.on('locationerror', onLocationError);

    function locate() {
      map.locate({setView: false, maxZoom: 14});
    }

    setInterval(locate, 10000); // Update location every 3 seconds
  </script>
</body>
</html>
